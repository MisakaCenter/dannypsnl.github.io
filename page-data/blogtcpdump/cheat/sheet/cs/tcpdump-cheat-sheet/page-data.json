{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogtcpdump/cheat/sheet//cs/tcpdump-cheat-sheet/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://dannypsnl.github.io"}},"markdownRemark":{"html":"<p>tcpdump?</p>\n<p>A command line tool for analyzing network packets.</p>\n<p>How to get packets?</p>\n<p>Using <code class=\"language-text\">-i</code> option, <code class=\"language-text\">tcpdump -i &lt;device-name&gt;</code>, you would get the packet through NIC(network interface card) named <device-name>.</device-name></p>\n<p>How to get <code class=\"language-text\">&lt;device-name&gt;</code>?</p>\n<p>using <code class=\"language-text\">ip link</code> could get some, e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ip link\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue state UNKNOWN\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    link/ether 08:01:37:d1:9c:bd brd ff:ff:ff:ff:ff:ff\n$ tcpdump -i eth0</code></pre></div>\n<p>Now I know how to get all packets through certain NIC, but I want to analysis specify connections, how can I get it?</p>\n<p>Expression.</p>\n<p>What Expression?</p>\n<p>tcpdump expression.</p>\n<p>What is tcpdump expression?</p>\n<p>A set of combinable rules, for example <code class=\"language-text\">src 10.0.0.10</code> means only the packets from <code class=\"language-text\">10.0.0.10</code> would show.Here is a list(incomplete) of tcpdump expression, the <code class=\"language-text\">#</code> leading comments:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">host 10.0.0.10 # from or to 10.0.0.10\nport 23 # contains port 23\ndst 10.0.0.10 # as src, but for destination\n# Protocols\narp # only ARP\nicmp\ntcp\nudp\nfddi\nether\n# Protocol logic is simple, is not, for all</code></pre></div>\n<p>You say they are combinable, how they combined?</p>\n<p>Good question, they can be combined with <code class=\"language-text\">or</code>, <code class=\"language-text\">and</code> or with leading <code class=\"language-text\">!</code>(not); <code class=\"language-text\">or</code> is <code class=\"language-text\">or</code>, not <code class=\"language-text\">and</code>, for example, <code class=\"language-text\">src 10.0.0.10 or src 10.0.0.11</code> is for packets from <code class=\"language-text\">10.0.0.10</code> or <code class=\"language-text\">10.0.0.11</code>, obviously.</p>\n<p>I found packets not showing all informations I want, what could I do?</p>\n<p>Simple, tcpdump has <code class=\"language-text\">-v</code> for verbose output, <code class=\"language-text\">-vv</code> for more verbose, <code class=\"language-text\">-vvv</code> for even more verbose. <code class=\"language-text\">-vvvv</code> for… no, I’m kidding.</p>\n<p>Ha, that’s funny, and the timestamp is not readable for me, how to make it more friendly?</p>\n<p>Use <code class=\"language-text\">-t</code>, and not kidding, use <code class=\"language-text\">-ttttt</code> for maximally timestamp, and you have <code class=\"language-text\">-kt, k &lt;- 1..=5</code> for different level output.</p>\n<p>I found the IP be replaced by host name but I don’t want it, how to remove it?</p>\n<p><code class=\"language-text\">-n</code> would tell <code class=\"language-text\">tcpdump</code> stop convert address.</p>\n<p>What if I want to save my hard working result?</p>\n<p><code class=\"language-text\">-w &lt;filename&gt;</code> is what you’re looking for, it would write the raw packets to file named <code class=\"language-text\">&lt;filename&gt;</code> rather than parsing &#x26; printing. And remember you can record packets into a file, and use <strong><a href=\"https://www.wireshark.org/download.html\">Wireshark</a></strong> to analysis it! For complex flow analyzing, I would do that. Now, the most important path already covered, you can always get more &#x26; fresher information about it from <code class=\"language-text\">manpage</code> of <code class=\"language-text\">tcpdump</code>, good lucks.</p>\n<h4>references</h4>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Network_interface_controller\">wiki: NIC</a></li>\n<li><a href=\"https://www.tcpdump.org/manpages/tcpdump.1.html\">man: tcpdump</a></li>\n</ul>","frontmatter":{"title":"tcpdump cheat sheet","categories":["cs"],"tags":["tcpdump","networking"]}}},"pageContext":{"slug":"/blogtcpdump/cheat/sheet//cs/tcpdump-cheat-sheet/"}}}