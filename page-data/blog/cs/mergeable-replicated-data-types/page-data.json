{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/cs/mergeable-replicated-data-types/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://dannypsnl.github.io"}},"markdownRemark":{"html":"<p><a href=\"http://kcsrk.info/papers/oopsla19-mrdt.pdf\">Mergeable replicated data types</a> Kaki et al., OOPSLA’19</p>\n<p>First, we need to know the context we need mergeable replicated data types(MRDT). In the introduction the authors mention:</p>\n<blockquote>\n<p>Modern distributed data-intensive applications often replicate data across geographically diverse locations to (a) enable trust decentralization, (b) guarantee low-latency access to application state, and (c) provide high availability even in the face of node and network failures.</p>\n</blockquote>\n<p>To archive the target, and furthermore to have an automatic derivation of correct distributed(which means replicated) variants of ordinary data types. Their key approach was an invertible relational specification of an inductive data\ntype definition.</p>\n<p>What they do was versioned states with explicit merges, basically is made by tracing the lowest common ancestor(LCA) version of merging versions.</p>\n<p>Let's first look at a trivial example in the paper, counter:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\"><span class=\"token keyword\">module</span> <span class=\"token module variable\">Counter</span> <span class=\"token punctuation\">:</span> <span class=\"token module variable\">COUNTER</span> <span class=\"token operator\">=</span>\n<span class=\"token keyword\">struct</span>\n  <span class=\"token keyword\">type</span> t <span class=\"token operator\">=</span> int\n  <span class=\"token keyword\">let</span> zero <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n  <span class=\"token keyword\">let</span> add x v <span class=\"token operator\">=</span> v <span class=\"token operator\">+</span> x\n  <span class=\"token keyword\">let</span> sub x v <span class=\"token operator\">=</span> v <span class=\"token operator\">-</span> x\n  <span class=\"token keyword\">let</span> mult x v <span class=\"token operator\">=</span> x <span class=\"token operator\">*</span> v\n  <span class=\"token keyword\">let</span> read v <span class=\"token operator\">=</span> v\n<span class=\"token keyword\">end</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.75675675675677%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd8SLJD/xAAWEAEBAQAAAAAAAAAAAAAAAAAQEQD/2gAIAQEAAQUCbqf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAAAARARMWGR/9oACAEBAAE/IWYihTfBOz//2gAMAwEAAgADAAAAEBDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAQEBAAMBAAAAAAAAAAAAARExABAhcZH/2gAIAQEAAT8QaQNc72itvhi27MeA1T9cIpfx7//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts fig 2\"\n        title=\"mrdts fig 2\"\n        src=\"/static/c36a97bc29da98d441ea2e3a808d62aa/1c72d/mrdts-fig-2.jpg\"\n        srcset=\"/static/c36a97bc29da98d441ea2e3a808d62aa/a80bd/mrdts-fig-2.jpg 148w,\n/static/c36a97bc29da98d441ea2e3a808d62aa/1c91a/mrdts-fig-2.jpg 295w,\n/static/c36a97bc29da98d441ea2e3a808d62aa/1c72d/mrdts-fig-2.jpg 590w,\n/static/c36a97bc29da98d441ea2e3a808d62aa/80e3c/mrdts-fig-2.jpg 720w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>If there has a initial state with integer <code class=\"language-text\">5</code>, and it has two child versions occured by <code class=\"language-text\">*2</code>(to make it more clear for non-cs people, this equal to <code class=\"language-text\">x2</code>) and <code class=\"language-text\">-1</code>. <code class=\"language-text\">*2</code> occurs version one <code class=\"language-text\">10</code>, <code class=\"language-text\">-1</code> occurs version two <code class=\"language-text\">4</code>. Now we merge version one and version two: merge <code class=\"language-text\">10</code> <code class=\"language-text\">4</code>, we can find the LCA of them are <code class=\"language-text\">5</code>, now let's define our merge function:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\"><span class=\"token keyword\">let</span> merge lca v1 v2 <span class=\"token operator\">=</span> lca <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span> v1 <span class=\"token operator\">-</span> lca <span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span> v2 <span class=\"token operator\">-</span> lca <span class=\"token punctuation\">)</span></code></pre></div>\n<p>Notice that the result does not guarantee linearizability, for example with v1 occured by <code class=\"language-text\">*2</code> and v2 by <code class=\"language-text\">*3</code>.</p>\n<p>The result is: <code class=\"language-text\">merge 5 10 15</code> which is <code class=\"language-text\">25</code>, not <code class=\"language-text\">5 * 2 * 3 = 30</code>, but it guarantees convergence.</p>\n<p>Next we have a new thing: relational domain:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 112.83783783783782%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAXABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe8sKDChoD//xAAWEAEBAQAAAAAAAAAAAAAAAAABADD/2gAIAQEAAQUCwC//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAZEAEAAwEBAAAAAAAAAAAAAAABABARMSH/2gAIAQEAAT8h0m52zlMBfCME/9oADAMBAAIAAwAAABDTyAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAeEAEAAgEEAwAAAAAAAAAAAAABABFBECExYVGRof/aAAgBAQABPxBbYbgDS9wRLI8S9FvS1vT57iOQ+REJmf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts fig 3\"\n        title=\"mrdts fig 3\"\n        src=\"/static/6cee4a1be8ced1c7f151301a6e2ff24b/1c72d/mrdts-fig-3.jpg\"\n        srcset=\"/static/6cee4a1be8ced1c7f151301a6e2ff24b/a80bd/mrdts-fig-3.jpg 148w,\n/static/6cee4a1be8ced1c7f151301a6e2ff24b/1c91a/mrdts-fig-3.jpg 295w,\n/static/6cee4a1be8ced1c7f151301a6e2ff24b/1c72d/mrdts-fig-3.jpg 590w,\n/static/6cee4a1be8ced1c7f151301a6e2ff24b/a8a14/mrdts-fig-3.jpg 885w,\n/static/6cee4a1be8ced1c7f151301a6e2ff24b/6a068/mrdts-fig-3.jpg 960w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>The semantics of a merge in the relational set domain, albeit non-trivial, is nonetheless standard in the sense that it is independent of the concrete interpretations (in the data type domain) of the merging relations, and hence can be defined once and for all.</p>\n</blockquote>\n<p>Queue example would show why we need relational domain.</p>\n<p>Consider LCA of queue Q and two concurrent versions v1 and v2 to be merged. What should we do to guarantee convergence?</p>\n<ol>\n<li>A queue element that was never popped in either version should still present in v.</li>\n<li>For every element in Q, if it is popped in either v1 or v2 then it should not present in v. Note that <code class=\"language-text\">[2;2]</code> has two different elements, the same value didn't mean they are the same element.</li>\n<li>If an element is not in Q and it is newly pushed into v1 or v2 then should in v.</li>\n<li>Partial ordering is preserved: for every element e1 and e2 in Q(or v1, or v2) then if e1 and e2 are not deleted then e1 also occurs before e2 in v. With these, we can map queue state to relations using two relations: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>m</mi><mi>e</mi><mi>m</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{mem}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">m</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is a set containing all the members of a queue, and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>o</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{ob}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is an occurs-before relation relating every pair of elements e1 and e2 in the queue such that if e1 occurs before e2 in the queue, then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>e</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>e</mi><mn>2</mn><mo stretchy=\"false\">)</mo><mo>∈</mo><msub><mi>R</mi><mrow><mi>o</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">(e1, e2) \\in R_{ob}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">e</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">e</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>.</li>\n</ol>\n<p>Now that we know how to map queues to the relational domain, we define the three-way merge operation in that domain as:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.108108108108107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAXElEQVQI1z1OSQoAIBDq/08MOrVSly4VRGU4UII4g6Cq1hp677DWwjmHlBJCCIgxopQiyp/enBMP5xzsvf9NEmqtJcYYA7VWeO9hjBEykKq1Fo/lL5zFOec/5IVfJDOX2DE9HPcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts fig 4\"\n        title=\"mrdts fig 4\"\n        src=\"/static/0e01b3844bfe4274751aead9c7b06c1f/fcda8/mrdts-fig-4.png\"\n        srcset=\"/static/0e01b3844bfe4274751aead9c7b06c1f/12f09/mrdts-fig-4.png 148w,\n/static/0e01b3844bfe4274751aead9c7b06c1f/e4a3f/mrdts-fig-4.png 295w,\n/static/0e01b3844bfe4274751aead9c7b06c1f/fcda8/mrdts-fig-4.png 590w,\n/static/0e01b3844bfe4274751aead9c7b06c1f/efc66/mrdts-fig-4.png 885w,\n/static/0e01b3844bfe4274751aead9c7b06c1f/c83ae/mrdts-fig-4.png 1180w,\n/static/0e01b3844bfe4274751aead9c7b06c1f/b5a09/mrdts-fig-4.png 1360w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>and</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.486486486486488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZElEQVQI1z2M2wpAERBF/f/3eUWJPAh5cKd9MuVMraa1Z9rMOQfvPVprhLWWUErh3owxEEKglIK1FmqtGGOQ997x5pxDOdt7k1zuc0oJIQRwzqlQSgmtNZXlnCl7O8b4F845yT8m9JiSDwDkogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts fig 5\"\n        title=\"mrdts fig 5\"\n        src=\"/static/a5563cf0417488e06da5d3bd3b9af915/fcda8/mrdts-fig-5.png\"\n        srcset=\"/static/a5563cf0417488e06da5d3bd3b9af915/12f09/mrdts-fig-5.png 148w,\n/static/a5563cf0417488e06da5d3bd3b9af915/e4a3f/mrdts-fig-5.png 295w,\n/static/a5563cf0417488e06da5d3bd3b9af915/fcda8/mrdts-fig-5.png 590w,\n/static/a5563cf0417488e06da5d3bd3b9af915/efc66/mrdts-fig-5.png 885w,\n/static/a5563cf0417488e06da5d3bd3b9af915/c83ae/mrdts-fig-5.png 1180w,\n/static/a5563cf0417488e06da5d3bd3b9af915/62da8/mrdts-fig-5.png 1262w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>After merging states in the relational domain according to rules, we can make it back into the queue domain.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd4SLJD/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAx/9oACAEBAAE/IYh7Ef/aAAwDAQACAAMAAAAQkM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAgMBAAAAAAAAAAAAAAABABEhMUFR/9oACAEBAAE/ELS23s6GczSJtllvrE1uf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts fig 6\"\n        title=\"mrdts fig 6\"\n        src=\"/static/b4385265f73d9021f65013148c10f2e7/1c72d/mrdts-fig-6.jpg\"\n        srcset=\"/static/b4385265f73d9021f65013148c10f2e7/a80bd/mrdts-fig-6.jpg 148w,\n/static/b4385265f73d9021f65013148c10f2e7/1c91a/mrdts-fig-6.jpg 295w,\n/static/b4385265f73d9021f65013148c10f2e7/1c72d/mrdts-fig-6.jpg 590w,\n/static/b4385265f73d9021f65013148c10f2e7/a8a14/mrdts-fig-6.jpg 885w,\n/static/b4385265f73d9021f65013148c10f2e7/c7398/mrdts-fig-6.jpg 1154w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Functions that compute Rmem and Rob relations for a list. The syntax is stylized to aid comprehension:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\"><span class=\"token keyword\">let</span> <span class=\"token keyword\">rec</span> <span class=\"token module variable\">Rmem</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-></span> ∅\n  <span class=\"token operator\">|</span> x <span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span> xs <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span> x <span class=\"token punctuation\">}</span> ∪ <span class=\"token module variable\">Rmem</span> <span class=\"token punctuation\">(</span> xs <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> <span class=\"token keyword\">rec</span> <span class=\"token module variable\">Rob</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-></span> ∅\n  <span class=\"token operator\">|</span> x <span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span> xs <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> x <span class=\"token punctuation\">}</span> × <span class=\"token module variable\">Rmem</span> <span class=\"token punctuation\">(</span> xs <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> ∪ <span class=\"token module variable\">Rob</span> <span class=\"token punctuation\">(</span> xs <span class=\"token punctuation\">)</span></code></pre></div>\n<p>An implementation strategy of the queue state from relations <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>m</mi><mi>e</mi><mi>m</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{mem}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">m</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>o</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{ob}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is constructing a directed graph with vertices <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>m</mi><mi>e</mi><mi>m</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R_{mem}(v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">m</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span> and edges <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>o</mi><mi>b</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R_{ob}(v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span>, and ties broken with additional arbitration edges. A topological ordering of the graph then yields the queue.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9ENg//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAh/9oACAEBAAEFAjY7/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQUREhMf/aAAgBAQABPyHNCdDclw//2gAMAwEAAgADAAAAEGAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAIBBQAAAAAAAAAAAAAAAQAhERAxQVFh/9oACAEBAAE/EG6ZKeRBYL5YdsTdHS//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts fig 7\"\n        title=\"mrdts fig 7\"\n        src=\"/static/5de4c24dccfa9cf36c0e50ab906efaf3/1c72d/mrdts-fig-7.jpg\"\n        srcset=\"/static/5de4c24dccfa9cf36c0e50ab906efaf3/a80bd/mrdts-fig-7.jpg 148w,\n/static/5de4c24dccfa9cf36c0e50ab906efaf3/1c91a/mrdts-fig-7.jpg 295w,\n/static/5de4c24dccfa9cf36c0e50ab906efaf3/1c72d/mrdts-fig-7.jpg 590w,\n/static/5de4c24dccfa9cf36c0e50ab906efaf3/a8a14/mrdts-fig-7.jpg 885w,\n/static/5de4c24dccfa9cf36c0e50ab906efaf3/67d3c/mrdts-fig-7.jpg 1131w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>We have generalized the aforementioned graph-based approach for concretizing ordering relations and abstracted it away as a library function <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>γ</mi><mrow><mi>o</mi><mi>r</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\gamma_{ord}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05556em;\">γ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>. Give ord, an arbitration order the function <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>γ</mi><mrow><mi>o</mi><mi>r</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\gamma_{ord}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05556em;\">γ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> concretizes an ordering relation of a data structure (not necessarily a total order) as a graph isomorphic to that structure, using the arbitration order to break ties…</p>\n</blockquote>\n<p>Now we are getting closer to the general MRDT approach now. For each data type can define characteristic relations that define representation in the relational domain(like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>m</mi><mi>e</mi><mi>m</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{mem}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">m</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>o</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{ob}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> in the queue), The following table shows the characteristic relations for a range of data types.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.513513513513516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdiQWA//xAAXEAEAAwAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAEFAtpD/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEQMUH/2gAIAQEABj8Ctmx//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAExIf/aAAgBAQABPyFgJZRB/9oADAMBAAIAAwAAABDzz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAAICAwEAAAAAAAAAAAAAAAERACExYXHw/9oACAEBAAE/EKpBC4dG/wBqUyJ7P//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mrdts table 1\"\n        title=\"mrdts table 1\"\n        src=\"/static/bd4862c354f6bfc61cf7ec1270cdffff/1c72d/mrdts-table-1.jpg\"\n        srcset=\"/static/bd4862c354f6bfc61cf7ec1270cdffff/a80bd/mrdts-table-1.jpg 148w,\n/static/bd4862c354f6bfc61cf7ec1270cdffff/1c91a/mrdts-table-1.jpg 295w,\n/static/bd4862c354f6bfc61cf7ec1270cdffff/1c72d/mrdts-table-1.jpg 590w,\n/static/bd4862c354f6bfc61cf7ec1270cdffff/a8a14/mrdts-table-1.jpg 885w,\n/static/bd4862c354f6bfc61cf7ec1270cdffff/b3430/mrdts-table-1.jpg 1122w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>I haven't read whole content in MRDT, it seems like they are going to create atomically derive merge specification for an MRDT given the characteristic relations and the abstraction/concretization functions.</p>\n<p>This is just a note, so I do not provide too many what I thought. And takes a lot word from paper XD.</p>","frontmatter":{"title":"Mergeable replicated data types","categories":["cs"],"tags":["paper","data-structure"]}}},"pageContext":{"slug":"/blog/cs/mergeable-replicated-data-types/"}}}