{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2018/11/30/cs/fun-network-tcp-close/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://dannypsnl.github.io"}},"markdownRemark":{"html":"<p>Recently we are working on a new feature is about filter packets by HTTP header for our router.\nThis is the concept, we read the header by rules, rules are just some key/value pair.\nIf key missing or value isn't matched, then we drop the packet.</p>\n<p>When a connection end, we would remove this connection from allowing pass map.</p>\n<p>Anyway, we found a bug is, we use FIN flag to say this packet is the end of the TCP connection,\nbut we know a connection end is <code class=\"language-text\">a:FIN</code> -> <code class=\"language-text\">b:ACK</code> -> <code class=\"language-text\">b:FIN</code> -> <code class=\"language-text\">a:ACK</code>, a/b is client/server here.\nSo except the first packet, following packets won't pass our router,\nthen connection would never end until timeout, lol.</p>","frontmatter":{"title":"fun networking: tcp close","categories":["cs"],"tags":["workrecord","networking","tcp"]}}},"pageContext":{"slug":"/blog/2018/11/30/cs/fun-network-tcp-close/"}}}